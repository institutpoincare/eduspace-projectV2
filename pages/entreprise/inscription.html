<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nouvelle Inscription - EduCorp</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/dashboard.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4f46e5',
                        secondary: '#4338ca',
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            900: '#0c4a6e',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.5s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-gray-50 h-screen overflow-hidden flex">

    <!-- Decorative Side Panel -->
    <div
        class="hidden lg:flex w-1/3 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 relative flex-col justify-between p-12 text-white overflow-hidden">
        <!-- Abstract Shapes -->
        <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
            <div class="absolute top-10 -left-10 w-64 h-64 rounded-full bg-white blur-3xl"></div>
            <div class="absolute bottom-10 -right-10 w-96 h-96 rounded-full bg-blue-400 blur-3xl"></div>
        </div>

        <div class="relative z-10 animate-fade-in">
            <button onclick="window.location.href='dashboard-admin.html'"
                class="flex items-center gap-2 text-white/80 hover:text-white transition-colors mb-8 group">
                <div class="p-2 bg-white/10 rounded-lg group-hover:bg-white/20 transition-all">
                    <i data-lucide="arrow-left" class="w-5 h-5"></i>
                </div>
                <span class="font-medium">Retour au Dashboard</span>
            </button>
            <h1 class="text-4xl font-bold leading-tight mb-4">Bienvenue <br />Nouvel Apprenant ! 🎓</h1>
            <p class="text-indigo-100 text-lg opacity-90">Commencez une nouvelle aventure d'apprentissage. Remplissez
                simplement les informations pour démarrer.</p>
        </div>

        <div class="relative z-10 space-y-6 animate-slide-up" style="animation-delay: 0.2s;">
            <div class="flex items-center gap-4">
                <div
                    class="w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/10">
                    <i data-lucide="shield-check" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h3 class="font-bold text-lg">Données Sécurisées</h3>
                    <p class="text-sm text-indigo-100 opacity-80">Conforme RGPD & standards de sécurité.</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div
                    class="w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/10">
                    <i data-lucide="zap" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <h3 class="font-bold text-lg">Activation Immédiate</h3>
                    <p class="text-sm text-indigo-100 opacity-80">Accès aux cours dès la validation.</p>
                </div>
            </div>
        </div>

        <div class="text-xs text-indigo-200 opacity-60 relative z-10">
            © 2025 EduCorp Enterprise Solutions
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="flex-1 overflow-y-auto bg-gray-50 flex flex-col">
        <div class="flex-1 flex flex-col justify-center max-w-3xl mx-auto w-full p-8 lg:p-12">

            <!-- Progress Bar -->
            <div class="mb-10 animate-fade-in">
                <div class="flex justify-between items-end mb-2">
                    <span class="text-sm font-bold text-indigo-600 uppercase tracking-wider" id="step-label">Étape 1 sur
                        3</span>
                    <span class="text-sm font-medium text-gray-400">Progression</span>
                </div>
                <div class="h-2 w-full bg-gray-200 rounded-full overflow-hidden">
                    <div id="progress-bar"
                        class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 w-1/3 transition-all duration-500 ease-out">
                    </div>
                </div>
            </div>

            <!-- Form Container -->
            <div
                class="bg-white rounded-3xl shadow-xl shadow-gray-200/50 border border-white p-8 lg:p-10 animate-slide-up backdrop-blur-xl relative overflow-hidden">

                <!-- Decoration -->
                <div
                    class="absolute top-0 right-0 w-32 h-32 bg-indigo-50 rounded-bl-full -mr-8 -mt-8 opacity-50 pointer-events-none">
                </div>

                <!-- STEP 1: Student Details -->
                <div id="step-1" class="space-y-6">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Qui est le nouvel inscrit ?</h2>
                        <p class="text-gray-500">Saisissez les informations personnelles de l'apprenant.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-1 group">
                            <label
                                class="block text-sm font-bold text-gray-700 ml-1 group-focus-within:text-indigo-600 transition-colors">Prénom</label>
                            <div class="relative">
                                <i data-lucide="user"
                                    class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors"></i>
                                <input type="text" placeholder="Ex: Ahmed"
                                    class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all placeholder:text-gray-400 font-medium text-gray-900">
                            </div>
                        </div>
                        <div class="space-y-1 group">
                            <label
                                class="block text-sm font-bold text-gray-700 ml-1 group-focus-within:text-indigo-600 transition-colors">Nom</label>
                            <div class="relative">
                                <i data-lucide="user"
                                    class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors"></i>
                                <input type="text" placeholder="Ex: Ben Ali"
                                    class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all placeholder:text-gray-400 font-medium text-gray-900">
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-1 group">
                            <label
                                class="block text-sm font-bold text-gray-700 ml-1 group-focus-within:text-indigo-600 transition-colors">Date
                                de Naissance</label>
                            <div class="relative">
                                <i data-lucide="calendar"
                                    class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors"></i>
                                <input type="text" id="dob" placeholder="JJ/MM/AAAA"
                                    class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all placeholder:text-gray-400 font-medium text-gray-900">
                            </div>
                        </div>
                        <div class="space-y-1 group">
                            <label
                                class="block text-sm font-bold text-gray-700 ml-1 group-focus-within:text-indigo-600 transition-colors">Téléphone</label>
                            <div class="relative">
                                <i data-lucide="phone"
                                    class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors"></i>
                                <input type="tel" placeholder="+216 00 000 000"
                                    class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all placeholder:text-gray-400 font-medium text-gray-900">
                            </div>
                        </div>
                    </div>
                    <div class="space-y-1 group">
                        <label
                            class="block text-sm font-bold text-gray-700 ml-1 group-focus-within:text-indigo-600 transition-colors">Email</label>
                        <div class="relative">
                            <i data-lucide="mail"
                                class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors"></i>
                            <input type="email" placeholder="email@exemple.com"
                                class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all placeholder:text-gray-400 font-medium text-gray-900">
                        </div>
                    </div>
                </div>

                <!-- STEP 2: Payment -->
                <div id="step-2" class="hidden space-y-8 animate-fade-in">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-2">Choix de la Formation</h2>
                        <p class="text-gray-500">Sélectionnez le cursus et configurez les modalités de paiement.</p>
                    </div>

                    <div class="space-y-1">
                        <label class="block text-sm font-bold text-gray-700 ml-1">Formation</label>
                        <div class="relative">
                            <i data-lucide="book-open"
                                class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 z-10"></i>
                            <select id="courseSelect" onchange="updateTotal()"
                                class="w-full pl-12 pr-4 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:bg-white focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all font-bold text-gray-900 appearance-none cursor-pointer hover:bg-white">
                                <option value="1200" selected>Design Graphique (1 200 TND)</option>
                                <option value="2500">Développement Web (2 500 TND)</option>
                                <option value="1800">Marketing Digital (1 800 TND)</option>
                            </select>
                            <i data-lucide="chevron-down"
                                class="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"></i>
                        </div>
                    </div>

                    <div class="bg-indigo-50/50 rounded-2xl p-6 border border-indigo-100">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="font-bold text-indigo-900">Paiement Initial</h3>
                            <div class="px-3 py-1 bg-white rounded-lg shadow-sm text-xs font-bold text-indigo-600">
                                Requis</div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-1">
                                <label class="block text-xs font-bold text-gray-500 uppercase ml-1">Montant à
                                    verser</label>
                                <div class="relative">
                                    <input type="number" id="payAmount" oninput="checkPaymentStatus()" placeholder="0"
                                        class="w-full pl-4 pr-12 py-3 bg-white border-2 border-indigo-200 rounded-xl outline-none focus:border-indigo-500 font-bold text-xl text-indigo-700 transition-all placeholder-indigo-200 shadow-sm">
                                    <span
                                        class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 text-xs font-bold">TND</span>
                                </div>
                            </div>
                            <div class="space-y-1">
                                <label class="block text-xs font-bold text-gray-500 uppercase ml-1">Reste à
                                    payer</label>
                                <div id="remainingDisplay"
                                    class="w-full px-4 py-3 bg-gray-100 rounded-xl font-bold text-gray-500 text-xl flex items-center border border-transparent transition-all">
                                    1 200 TND</div>
                            </div>
                        </div>
                    </div>

                    <!-- Partial Payment Logic -->
                    <div id="partialPaymentSection" class="hidden">
                        <div class="flex items-start gap-4 p-4 bg-orange-50 rounded-2xl border border-orange-100 mb-6">
                            <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center shrink-0">
                                <i data-lucide="clock" class="w-5 h-5 text-orange-600"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-orange-900">Planification du Solde</h4>
                                <p class="text-xs text-orange-700 mt-1 mb-3">Le solde restant doit être planifié.
                                    Configurez un rappel automatique.</p>

                                <div class="flex flex-wrap items-end gap-4">
                                    <div class="space-y-1 w-full md:w-auto md:flex-1">
                                        <label class="block text-xs font-bold text-orange-800 uppercase ml-1">Date
                                            Échéance</label>
                                        <input type="text" id="dueDate"
                                            class="w-full px-4 py-2 border border-orange-200 rounded-xl focus:ring-2 focus:ring-orange-200 outline-none bg-white text-sm font-medium">
                                    </div>
                                    <label
                                        class="flex items-center gap-3 px-4 py-2 bg-white rounded-xl border border-orange-200 cursor-pointer hover:bg-orange-50/50 transition-colors">
                                        <div class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div
                                                class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-orange-500">
                                            </div>
                                        </div>
                                        <span class="text-xs font-bold text-gray-700">Rappel SMS</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Full Payment Logic -->
                    <div id="fullPaymentSection" class="hidden">
                        <div class="flex items-center gap-4 p-4 bg-green-50 rounded-2xl border border-green-100">
                            <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center shrink-0">
                                <i data-lucide="check-circle-2" class="w-5 h-5 text-green-600"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-green-900">Paiement Complet</h4>
                                <p class="text-xs text-green-700 mt-1">Le dossier sera clôturé et la facture envoyée par
                                    email.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="mt-10 flex items-center justify-between pt-6 border-t border-gray-100">
                    <button id="prevBtn" onclick="nextStep(1)"
                        class="hidden px-6 py-3 text-gray-500 font-bold hover:text-gray-900 hover:bg-gray-50 rounded-xl transition-colors flex items-center gap-2">
                        <i data-lucide="arrow-left" class="w-5 h-5"></i> Retour
                    </button>
                    <div class="flex-1"></div> <!-- Spacer -->
                    <button id="nextBtn" onclick="nextStep(2)"
                        class="px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-200 hover:shadow-xl hover:shadow-indigo-300 transition-all transform hover:-translate-y-0.5 flex items-center gap-2 text-lg">
                        Suivant <i data-lucide="arrow-right" class="w-5 h-5"></i>
                    </button>
                </div>

            </div>

            <!-- Help Text -->
            <div class="mt-6 text-center text-sm text-gray-400">
                <p>Besoin d'aide ? <a href="#" class="text-indigo-600 font-bold hover:underline">Consulter le guide
                        RH</a></p>
            </div>

        </div>
    </div>

    <!-- Scripts -->
    <script>
        lucide.createIcons();
        flatpickr("#dob", { dateFormat: "d/m/Y" });
        flatpickr("#dueDate", { dateFormat: "d/m/Y", minDate: "today" });

        let currentStep = 1;

        function nextStep(step) {
            // Update UI State
            currentStep = step;

            // Hide all steps
            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-2').classList.add('hidden');

            // Show target step
            const target = document.getElementById(`step-${step}`);
            target.classList.remove('hidden');
            target.classList.add('animate-slide-up');

            // Update Progress
            const bar = document.getElementById('progress-bar');
            const label = document.getElementById('step-label');
            const btnNext = document.getElementById('nextBtn');
            const btnPrev = document.getElementById('prevBtn');

            if (step === 1) {
                bar.style.width = '33%';
                label.innerText = 'Étape 1 sur 3';
                btnPrev.classList.add('hidden');
                btnNext.innerHTML = 'Suivant <i data-lucide="arrow-right" class="w-5 h-5"></i>';
                btnNext.onclick = () => nextStep(2);
            } else if (step === 2) {
                bar.style.width = '66%';
                label.innerText = 'Étape 2 sur 3';
                btnPrev.classList.remove('hidden');
                btnNext.innerHTML = '<i data-lucide="check" class="w-5 h-5"></i> Valider Inscription';
                btnNext.onclick = () => finishRegistration();
            }
            // Re-render icons
            if (window.lucide) lucide.createIcons();
        }

        function updateTotal() {
            checkPaymentStatus();
        }

        function checkPaymentStatus() {
            const total = parseFloat(document.getElementById('courseSelect').value);
            const paid = parseFloat(document.getElementById('payAmount').value) || 0;
            const remaining = total - paid;

            const display = document.getElementById('remainingDisplay');
            const partialSec = document.getElementById('partialPaymentSection');
            const fullSec = document.getElementById('fullPaymentSection');

            if (remaining <= 0) {
                display.innerText = "0 TND (Payé)";
                display.className = "w-full px-4 py-3 bg-green-50 text-green-600 border border-green-200 rounded-xl font-bold text-xl flex items-center transition-all";

                partialSec.classList.add('hidden');
                fullSec.classList.remove('hidden');
                fullSec.classList.add('animate-slide-up');
            } else {
                display.innerText = remaining + " TND";
                display.className = "w-full px-4 py-3 bg-orange-50 text-orange-600 border border-orange-200 rounded-xl font-bold text-xl flex items-center transition-all";

                partialSec.classList.remove('hidden');
                partialSec.classList.add('animate-slide-up');
                fullSec.classList.add('hidden');
            }
        }

        function finishRegistration() {
            // Animate button
            const btn = document.getElementById('nextBtn');
            btn.innerHTML = '<i data-lucide="loader-2" class="w-5 h-5 animate-spin"></i> Traitement...';
            btn.classList.add('brightness-90', 'cursor-not-allowed');

            setTimeout(() => {
                alert("🎉 Inscription réussie ! \nL'apprenant a été ajouté et la facture a été générée.");
                window.location.href = 'employes.html';
            }, 1000);
        }
    </script>
    <!-- Dynamic System Scripts -->
    <script src="../../js/core/data-manager.js"></script>
</body>

</html>